(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/index/group"],{1397:function(t,e,s){"use strict";s.r(e);var i=s("6910"),o=s("d323");for(var a in o)"default"!==a&&function(t){s.d(e,t,function(){return o[t]})}(a);s("de3c");var c=s("2877"),n=Object(c["a"])(o["default"],i["a"],i["b"],!1,null,null,null);e["default"]=n.exports},"28d5":function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=v(s("0efe")),o=v(s("f557")),a=v(s("dd9c")),c=v(s("df8c")),n=v(s("d92d")),r=v(s("8a33")),l=s("6f5d"),d=s("6740"),u=v(s("0812")),m=v(s("321c")),p=v(s("da38")),g=v(s("e835"));function v(t){return t&&t.__esModule?t:{default:t}}function f(t){return b(t)||C(t)||h()}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function C(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function b(t){if(Array.isArray(t)){for(var e=0,s=new Array(t.length);e<t.length;e++)s[e]=t[e];return s}}var _={components:{uniSegmentedControl:i.default,lvvPopup:o.default,uniNumberBox:a.default,uniRate:c.default,uniLoadMore:n.default,uniFab:r.default,uniCountdown:u.default,spec:m.default,jshopContent:g.default,shareByWx:p.default},data:function(){return{myShareCode:"",swiper:{indicatorDots:!0,autoplay:!0,interval:3e3,duration:800},items:["图文详情","商品参数","买家评论"],current:0,goodsId:0,groupId:0,goodsInfo:{},cartNums:0,product:{},goodsParams:[],goodsComments:{loadStatus:"more",page:1,limit:5,list:[]},buyNum:1,minBuyNum:1,type:1,isfav:!1,favLogo:["/static/image/ic-me-collect.png","/static/image/ic-me-collect2.png"],horizontal:"right",vertical:"bottom",direction:"vertical",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#FF7159"},content:[{iconPath:"/static/image/tab-ic-hom-selected.png",selectedIconPath:"/static/image/tab-ic-hom-unselected.png",active:!1,url:"/pages/index/index"},{iconPath:"/static/image/tab-ic-me-selected.png",selectedIconPath:"/static/image/tab-ic-me-unselected.png",active:!1,url:"/pages/member/index/index"}],indicatorDots:!1,autoplay:!1,interval:2e3,duration:500,lasttime:{hour:!1,minute:0,second:0}}},onLoad:function(e){this.goodsId=e.id,this.groupId=e.group_id,this.goodsId&&this.groupId?(this.getGoodsInfo(),this.getGoodsParams(),this.getGoodsComments()):this.$common.errorToShow("获取失败",function(){t.navigateBack({delta:1})}),this.getCartNums(),this.getMyShareCode()},computed:{minNums:function(){return this.product.stock>this.minBuyNum?this.minBuyNum:this.product.stock},isSpes:function(){return!(!this.product.hasOwnProperty("default_spes_desc")||!Object.keys(this.product.default_spes_desc).length)},promotion:function(){var t=[];if(this.product.promotion_list)for(var e in this.product.promotion_list)t.push(this.product.promotion_list[e]);return t},typeName:function(){return 3==this.goodsInfo.group_type?"团购":"秒杀"},shareHref:function(){var t=getCurrentPages(),e=t[t.length-1];return d.apiBaseUrl+"wap/"+e.route+"?id="+this.goodsId+"&group_id="+this.groupId}},onReachBottom:function(){2===this.current&&"more"===this.goodsComments.loadStatus&&this.getGoodsComments()},methods:{backBtn:function(){t.navigateBack({delta:1})},getGoodsInfo:function(){var e=this,s={id:this.goodsId,group_id:this.groupId},i=(0,l.get)("userToken");i&&(s["token"]=i);var o=this;this.$api.groupInfo(s,function(s){if(s.status)if(s.data.length<1)e.$common.errorToShow("该商品不存在，请返回重新选择商品。",function(){t.navigateBack({delta:1})});else if(1!=s.data.marketable)e.$common.errorToShow("该商品已下架，请返回重新选择商品。",function(){t.navigateBack({delta:1})});else{var a=s.data,c=s.data.product;e.goodsInfo=a,e.isfav="true"===e.goodsInfo.isfav,e.product=e.spesClassHandle(c);var n=s.data.lasttime;o.lasttime=n,i&&e.goodsBrowsing()}})},getCartNums:function(){var t=this,e=this.$db.get("userToken");e&&""!=e&&this.$api.getCartNum({},function(e){e.status&&(t.cartNums=e.data)})},toshow:function(t){this.type=t,this.$refs.lvvpopref.show()},toclose:function(){this.$refs.lvvpopref.close()},changeSpes:function(e){var s=this,i=e.v,o=e.k;if(this.product.default_spes_desc[i][o].hasOwnProperty("product_id")&&this.product.default_spes_desc[i][o].product_id){var a={id:this.product.default_spes_desc[i][o].product_id},c=this.$db.get("userToken");c&&(a["token"]=c),this.$api.getProductInfo(a,function(t){1==t.status&&(s.buyNum=t.data.stock>s.minBuyNum?s.minBuyNum:t.data.stock,s.product=s.spesClassHandle(t.data))}),t.showLoading({title:"加载中"}),setTimeout(function(){t.hideLoading()},1e3)}},spesClassHandle:function(t){if(t.hasOwnProperty("default_spes_desc")){var e=t.default_spes_desc;for(var s in e)for(var i in e[s])e[s][i].hasOwnProperty("is_default")&&!0===e[s][i].is_default?this.$set(e[s][i],"cla","pop-m-item selected"):e[s][i].hasOwnProperty("product_id")&&e[s][i].product_id?this.$set(e[s][i],"cla","pop-m-item not-selected"):this.$set(e[s][i],"cla","pop-m-item none");t.default_spes_desc=e}return t},bindChange:function(t){this.buyNum=t},collection:function(){var t=this,e={goods_id:this.goodsInfo.id};this.$api.goodsCollection(e,function(e){e.status?(t.isfav=!t.isfav,t.$common.successToShow(e.msg)):t.$common.errorToShow(e.msg)})},onClickItem:function(t){this.current!==t&&(this.current=t)},getGoodsParams:function(){var t=this;this.$api.goodsParams({id:this.goodsId},function(e){1==e.status&&(t.goodsParams=e.data)})},getGoodsComments:function(){var t=this,e={page:this.goodsComments.page,limit:this.goodsComments.limit,goods_id:this.goodsId};this.goodsComments.loadStatus="loading",this.$api.goodsComment(e,function(e){if(1==e.status){var s=e.data.list;s.forEach(function(e){e.ctime=t.$common.timeToDate(e.ctime),e.hasOwnProperty("images_url")||t.$set(e,"images_url",[])}),t.goodsComments.list=[].concat(f(t.goodsComments.list),f(s)),e.data.count>t.goodsComments.list.length?(t.goodsComments.loadStatus="more",t.goodsComments.page++):t.goodsComments.loadStatus="noMore"}else t.$common.errorToShow(e.msg)})},goodsBrowsing:function(){var t={goods_id:this.goodsInfo.id};this.$api.addGoodsBrowsing(t,function(t){})},buyNow:function(){var t=this;if(this.buyNum>0){var e={product_id:this.product.id,nums:this.buyNum,order_type:1};this.$api.addCart(e,function(e){if(e.status){t.toclose();var s=e.data;t.$common.navigateTo("/pages/goods/place-order/index?cart_ids="+JSON.stringify(s))}else t.$common.errorToShow(e.msg)})}},Group:function(){var t=this;if(this.buyNum>0){var e={product_id:this.product.id,nums:this.buyNum,order_type:this.type};this.$api.addCart(e,function(e){if(e.status){t.toclose();var s=e.data;t.$common.navigateTo("/pages/goods/place-order/index?cart_ids="+JSON.stringify(s))}})}},redirectCart:function(){t.switchTab({url:"/pages/cart/index/index"})},trigger:function(e){this.content[e.index].active=!e.item.active,t.switchTab({url:e.item.url})},goShare:function(){this.$refs.share.show()},closeShare:function(){this.$refs.share.close()},clickImg:function(e){t.previewImage({urls:e.split()})},getMyShareCode:function(){var t=this,e=this.$db.get("userToken");e&&""!=e&&this.$api.shareCode({},function(e){e.status&&(t.myShareCode=e.data?e.data:"")})}},onShareAppMessage:function(){var t=this.myShareCode?this.myShareCode:"",e=this.$common.shareParameterDecode("type=6&id="+this.goodsId+"&group_id="+this.groupId+"&invite="+t),s="/pages/share/jump?scene="+e;return{title:this.goodsInfo.name,imageUrl:this.goodsInfo.album[0],path:s}}};e.default=_}).call(this,s("543d")["default"])},6910:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"content"},[s("view",{staticClass:"nav-back"},[s("view",{staticClass:"back-btn",attrs:{eventid:"4cb1a258-0"},on:{click:function(e){t.backBtn()}}},[s("image",{staticClass:"icon",attrs:{src:"/static/image/back-black.png",mode:""}})])]),s("view",{staticClass:"content-top"},[s("view",{staticClass:"swiper"},[s("swiper",{staticClass:"swiper-c",attrs:{"indicator-dots":t.swiper.indicatorDots,autoplay:t.swiper.autoplay,interval:t.swiper.interval,duration:t.swiper.duration}},t._l(t.goodsInfo.album,function(e,i){return s("swiper-item",{key:i,staticClass:"have-none",attrs:{eventid:"4cb1a258-1-"+i,mpcomid:"4cb1a258-0-"+i},on:{click:function(s){t.clickImg(e)}}},[s("image",{attrs:{src:e,mode:"aspectFill"}})])}))],1),s("view",{staticClass:"cell-group"},[!1!==t.lasttime.hour?s("view",{staticClass:"price-salesvolume"},[s("view",{staticClass:"commodity-price"},[s("text",{staticClass:"current-price"},[t._v("￥"+t._s(t.product.price))]),parseFloat(t.product.mktprice)>0?s("text",{staticClass:"cost-price"},[t._v("￥"+t._s(t.product.mktprice))]):t._e()]),s("view",{staticClass:"commodity-salesvolume"},[s("text",[t._v("已售"+t._s(t.goodsInfo.buy_count)+"件/剩余"+t._s(t.product.stock)+"件")]),s("text",[t._v("累计销售"+t._s(t.goodsInfo.buy_count)+"件")])]),s("view",{staticClass:"commodity-time-img"}),s("view",{staticClass:"commodity-time"},[s("text",[t._v("距结束仅剩")]),s("view",{staticClass:"commodity-day"},[s("uni-countdown",{attrs:{"show-day":!1,hour:t.lasttime.hour,minute:t.lasttime.minute,second:t.lasttime.second,mpcomid:"4cb1a258-1"}})],1)])]):t._e(),s("view",{staticClass:"cell-item goods-details"},[s("view",{staticClass:"cell-item-hd"},[s("view",{staticClass:"cell-hd-title"},[s("view",{staticClass:"color-3 fsz28 cell-hd-title-view"},[t._v(t._s(t.product.name))]),t.goodsInfo.brief?s("view",{staticClass:"color-9 fsz24 cell-hd-title-view"},[t._v(t._s(t.goodsInfo.brief))]):t._e()])]),s("view",{staticClass:"cell-item-ft"},[s("image",{staticClass:"cell-ft-next icon",attrs:{src:"/static/image/share.png",eventid:"4cb1a258-2"},on:{click:function(e){t.goShare()}}})])]),t.promotion.length?s("view",{staticClass:"cell-item goods-title-item"},[t._m(0),s("view",{staticClass:"cell-item-bd"},[s("view",{staticClass:"romotion-tip"},t._l(t.promotion,function(e,i){return s("view",{key:i,staticClass:"romotion-tip-item",class:2!==e.type?"bg-gray":""},[t._v(t._s(e.name))])}))])]):t._e(),t.isSpes?s("view",{staticClass:"cell-item goods-title-item"},[t._m(1),s("view",{staticClass:"cell-item-bd",attrs:{eventid:"4cb1a258-3"},on:{click:function(e){t.toshow()}}},[s("text",{staticClass:"cell-bd-text"},[t._v(t._s(t.product.spes_desc))])])]):t._e(),t._m(2)]),s("view",{staticClass:"goods-content"},[s("uni-segmented-control",{attrs:{current:t.current,values:t.items,"style-type":"text","active-color":"#333",eventid:"4cb1a258-4",mpcomid:"4cb1a258-2"},on:{clickItem:t.onClickItem}}),s("view",{staticClass:"goods-content-c"},[0===t.current?s("view",{staticClass:"goods-detail"},[t.goodsInfo.intro?s("jshopContent",{attrs:{content:t.goodsInfo.intro,mpcomid:"4cb1a258-3"}}):t._e()],1):1===t.current?s("view",{staticClass:"goods-parameter"},[t.goodsParams.length?s("view",{staticClass:"cell-group"},t._l(t.goodsParams,function(e,i){return s("view",{key:i,staticClass:"cell-item"},[s("view",{staticClass:"cell-item-hd"},[s("view",{staticClass:"cell-hd-title"},[t._v(t._s(e.name))])]),s("view",{staticClass:"cell-item-bd"},[s("text",{staticClass:"cell-bd-text"},[t._v(t._s(e.value))])])])})):t._e()]):2===t.current?s("view",{staticClass:"goods-assess"},[t.goodsComments.list.length?s("view",[t._l(t.goodsComments.list,function(e,i){return s("view",{key:i,staticClass:"goods-assess-item"},[s("view",{staticClass:"cell-group"},[s("view",{staticClass:"cell-item goods-title-item"},[s("view",{staticClass:"cell-item-hd"},[s("image",{staticClass:"user-head-img",attrs:{src:e.user.avatar,mode:"aspectFill"}})]),s("view",{staticClass:"cell-item-bd"},[s("view",{staticClass:"cell-bd-view"},[s("text",{staticClass:"cell-bd-text"},[t._v(t._s(e.user.nickname))]),s("view",{staticClass:"cell-bd-text-right"},[s("uni-rate",{attrs:{size:"16",disabled:"true",value:e.score,mpcomid:"4cb1a258-4-"+i}})],1)]),s("view",{staticClass:"cell-bd-view"},[s("text",{staticClass:"cell-bd-text color-9",staticStyle:{"margin-right":"16rpx"}},[t._v(t._s(e.ctime))]),s("text",{staticClass:"cell-bd-text color-9"},[t._v(t._s(e.addon))])])])])]),s("view",{staticClass:"gai-body"},[s("view",{staticClass:"gai-body-text"},[t._v(t._s(e.content))]),e.images_url.length?s("view",{staticClass:"gai-body-img"},t._l(e.images_url,function(e,o){return s("image",{key:o,attrs:{src:e,mode:"aspectFill",eventid:"4cb1a258-5-"+i+"-"+o},on:{click:function(s){t.clickImg(e)}}})})):t._e()])])}),s("uni-load-more",{attrs:{status:t.goodsComments.loadStatus,mpcomid:"4cb1a258-5"}})],2):s("view",{staticClass:"comment-none"},[s("image",{staticClass:"comment-none-img",attrs:{src:"/static/image/order.png",mode:""}})])]):t._e()])],1)]),s("lvv-popup",{ref:"share",attrs:{position:"bottom",mpcomid:"4cb1a258-7"}},[s("shareByWx",{attrs:{goodsId:t.goodsInfo.id,shareImg:t.goodsInfo.image_url,shareTitle:t.goodsInfo.name,shareContent:t.goodsInfo.brief,shareHref:t.shareHref,eventid:"4cb1a258-6",mpcomid:"4cb1a258-6"},on:{close:function(e){t.closeShare()}}})],1),s("lvv-popup",{ref:"lvvpopref",attrs:{position:"bottom",mpcomid:"4cb1a258-10"}},[s("view",{staticStyle:{width:"100%","max-height":"804rpx",background:"#FFFFFF",position:"absolute",left:"0",bottom:"0"}},[s("view",{staticClass:"pop-c"},[s("view",{staticClass:"pop-t"},[s("view",{staticClass:"goods-img"},[s("image",{attrs:{src:t.product.image_path,mode:"aspectFill"}})]),s("view",{staticClass:"goods-information"},[s("view",{staticClass:"pop-goods-name"},[t._v(t._s(t.product.name))]),s("view",{staticClass:"pop-goods-price red-price"},[t._v("￥ "+t._s(t.product.price))])]),s("view",{staticClass:"close-btn",attrs:{eventid:"4cb1a258-7"},on:{click:function(e){t.toclose()}}},[s("image",{attrs:{src:"/static/image/close.png"}})])]),s("scroll-view",{staticClass:"pop-m",staticStyle:{"max-height":"560rpx"},attrs:{"scroll-y":"true"}},[s("spec",{ref:"spec",attrs:{spesData:t.product.default_spes_desc,eventid:"4cb1a258-8",mpcomid:"4cb1a258-8"},on:{changeSpes:t.changeSpes}}),s("view",{staticClass:"goods-number"},[s("text",{staticClass:"pop-m-title"},[t._v("数量")]),s("view",{staticClass:"pop-m-bd-in"},[s("uni-number-box",{attrs:{min:t.minNums,max:t.product.stock,value:t.buyNum,eventid:"4cb1a258-9",mpcomid:"4cb1a258-9"},on:{change:t.bindChange}})],1)])],1),s("view",{staticClass:"pop-b"},[t.product.stock?s("button",{staticClass:"btn btn-square btn-b btn-all",attrs:{"hover-class":"btn-hover2",eventid:"4cb1a258-10"},on:{click:function(e){t.buyNow()}}},[t._v("确定")]):s("button",{staticClass:"btn btn-square btn-g btn-all"},[t._v("已售罄")])],1)],1)])]),s("div",{ref:"qrCodeDiv",attrs:{id:"qrCode"}}),s("view",{staticClass:"goods-bottom"},[s("view",{staticClass:"goods-bottom-ic",attrs:{eventid:"4cb1a258-11"},on:{click:t.collection}},[s("image",{staticClass:"icon",attrs:{src:t.isfav?t.favLogo[1]:t.favLogo[0],mode:""}}),t.isfav?t._e():s("view",[t._v("收藏")]),t.isfav?s("view",[t._v("已收藏")]):t._e()]),s("view",{staticClass:"goods-bottom-ic",attrs:{eventid:"4cb1a258-12"},on:{click:t.redirectCart}},[t.cartNums?s("view",{staticClass:"badge color-f"},[t._v(t._s(t.cartNums))]):t._e(),s("image",{staticClass:"icon",attrs:{src:"/static/image/ic-me-car.png",mode:""}}),s("view",[t._v("购物车")])]),s("button",{staticClass:"btn btn-square btn-b tl",attrs:{"hover-class":"btn-hover2",eventid:"4cb1a258-13"},on:{click:function(e){t.toshow(2)}}},[t._v("立即"+t._s(t.typeName))])],1),s("uni-fab",{attrs:{pattern:t.pattern,content:t.content,horizontal:t.horizontal,vertical:t.vertical,direction:t.direction,eventid:"4cb1a258-14",mpcomid:"4cb1a258-11"},on:{trigger:t.trigger}})],1)},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"cell-item-hd"},[s("view",{staticClass:"cell-hd-title"},[t._v("促销")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"cell-item-hd"},[s("view",{staticClass:"cell-hd-title"},[t._v("规格")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"cell-item goods-title-item"},[s("view",{staticClass:"cell-item-hd"},[s("view",{staticClass:"cell-hd-title"},[t._v("说明")])]),s("view",{staticClass:"cell-item-bd"},[s("view",{staticClass:"cell-bd-view"},[s("image",{staticClass:"goods-title-item-ic",attrs:{src:"/static/image/ic-dui.png",mode:""}}),s("text",{staticClass:"cell-bd-text"},[t._v("24小时内发货")])]),s("view",{staticClass:"cell-bd-view"},[s("image",{staticClass:"goods-title-item-ic",attrs:{src:"/static/image/ic-dui.png",mode:""}}),s("text",{staticClass:"cell-bd-text"},[t._v("7天拆封无条件退货")])])])])}];s.d(e,"a",function(){return i}),s.d(e,"b",function(){return o})},8449:function(t,e,s){},acb7:function(t,e,s){"use strict";s("faac");var i=a(s("b0ce")),o=a(s("1397"));function a(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(o.default))},d323:function(t,e,s){"use strict";s.r(e);var i=s("28d5"),o=s.n(i);for(var a in i)"default"!==a&&function(t){s.d(e,t,function(){return i[t]})}(a);e["default"]=o.a},de3c:function(t,e,s){"use strict";var i=s("8449"),o=s.n(i);o.a}},[["acb7","common/runtime","common/vendor"]]]);