(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/index/index"],{1732:function(t,s,e){"use strict";(function(t){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var i=g(e("0efe")),o=g(e("f557")),a=g(e("dd9c")),c=g(e("df8c")),n=g(e("d92d")),r=g(e("8a33")),l=(e("6f5d"),e("6740")),d=g(e("321c")),u=g(e("da38")),m=g(e("e835"));function g(t){return t&&t.__esModule?t:{default:t}}function v(t){return f(t)||h(t)||p()}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function h(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function f(t){if(Array.isArray(t)){for(var s=0,e=new Array(t.length);s<t.length;s++)e[s]=t[s];return e}}var b={components:{uniSegmentedControl:i.default,lvvPopup:o.default,uniNumberBox:a.default,uniRate:c.default,uniLoadMore:n.default,uniFab:r.default,spec:d.default,jshopContent:m.default,shareByWx:u.default},data:function(){return{myShareCode:"",swiper:{indicatorDots:!0,autoplay:!0,interval:3e3,duration:800},items:["图文详情","商品参数","买家评论"],current:0,goodsId:0,goodsInfo:{},cartNums:0,product:{},goodsParams:[],goodsComments:{loadStatus:"more",page:1,limit:5,list:[]},buyNum:1,minBuyNum:1,type:2,isfav:!1,favLogo:["/static/image/ic-me-collect.png","/static/image/ic-me-collect2.png"],horizontal:"right",vertical:"bottom",direction:"vertical",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#FF7159"},content:[{iconPath:"/static/image/tab-ic-hom-selected.png",selectedIconPath:"/static/image/tab-ic-hom-unselected.png",active:!1,url:"/pages/index/index"},{iconPath:"/static/image/tab-ic-me-selected.png",selectedIconPath:"/static/image/tab-ic-me-unselected.png",active:!1,url:"/pages/member/index/index"}],submitStatus:!1}},onLoad:function(s){""!=s.id&&(this.goodsId=s.id),this.goodsId?(this.getGoodsDetail(),this.getGoodsParams(),this.getGoodsComments()):this.$common.errorToShow("获取失败",function(){t.navigateBack({delta:1})}),this.getCartNums(),this.getMyShareCode()},onShow:function(){this.submitStatus=!1},computed:{minNums:function(){return this.product.stock>this.minBuyNum?this.minBuyNum:this.product.stock},isSpes:function(){return!(!this.product.hasOwnProperty("default_spes_desc")||!Object.keys(this.product.default_spes_desc).length)},promotion:function(){var t=[];if(this.product.promotion_list)for(var s in this.product.promotion_list)t.push(this.product.promotion_list[s]);return t},shareHref:function(){var t=getCurrentPages(),s=t[t.length-1];return l.apiBaseUrl+"wap/"+s.route+"?id="+this.goodsId}},onReachBottom:function(){2===this.current&&"more"===this.goodsComments.loadStatus&&this.getGoodsComments()},methods:{backBtn:function(){t.navigateBack({delta:1})},getGoodsDetail:function(){var s=this,e={id:this.goodsId},i=this.$db.get("userToken");i&&(e["token"]=i),this.$api.goodsDetail(e,function(e){if(1==e.status){var o=e.data,a=e.data.product;s.goodsInfo=o,s.isfav="true"===s.goodsInfo.isfav,s.product=s.spesClassHandle(a),i&&s.goodsBrowsing()}else s.$common.errorToShow(e.msg,function(){t.navigateBack({delta:1})})})},getCartNums:function(){var t=this,s=this.$db.get("userToken");s&&""!=s&&this.$api.getCartNum({},function(s){s.status&&(t.cartNums=s.data)})},toshow:function(t){this.type=t,this.$refs.lvvpopref.show()},toclose:function(){this.$refs.lvvpopref.close()},changeSpes:function(s){var e=this,i=s.v,o=s.k;if(this.product.default_spes_desc[i][o].hasOwnProperty("product_id")&&this.product.default_spes_desc[i][o].product_id){var a={id:this.product.default_spes_desc[i][o].product_id},c=this.$db.get("userToken");c&&(a["token"]=c),this.$api.getProductInfo(a,function(t){1==t.status&&(e.buyNum=t.data.stock>e.minBuyNum?e.minBuyNum:t.data.stock,e.product=e.spesClassHandle(t.data))}),t.showLoading({title:"加载中"}),setTimeout(function(){t.hideLoading()},1e3)}},spesClassHandle:function(t){if(t.hasOwnProperty("default_spes_desc")){var s=t.default_spes_desc;for(var e in s)for(var i in s[e])s[e][i].hasOwnProperty("is_default")&&!0===s[e][i].is_default?this.$set(s[e][i],"cla","pop-m-item selected"):s[e][i].hasOwnProperty("product_id")&&s[e][i].product_id?this.$set(s[e][i],"cla","pop-m-item not-selected"):this.$set(s[e][i],"cla","pop-m-item none");t.default_spes_desc=s}return t},bindChange:function(t){this.buyNum=t},collection:function(){var t=this,s={goods_id:this.goodsInfo.id};this.$api.goodsCollection(s,function(s){s.status?(t.isfav=!t.isfav,t.$common.successToShow(s.msg)):t.$common.errorToShow(s.msg)})},onClickItem:function(t){this.current!==t&&(this.current=t)},getGoodsParams:function(){var t=this;this.$api.goodsParams({id:this.goodsId},function(s){1==s.status&&(t.goodsParams=s.data)})},getGoodsComments:function(){var t=this,s={page:this.goodsComments.page,limit:this.goodsComments.limit,goods_id:this.goodsId};this.goodsComments.loadStatus="loading",this.$api.goodsComment(s,function(s){if(1==s.status){var e=s.data.list,i=s.data.count;t.items=["图文详情","商品参数","买家评论("+i+")"],e.forEach(function(s){s.ctime=t.$common.timeToDate(s.ctime,!0),s.hasOwnProperty("images_url")||t.$set(s,"images_url",[])}),t.goodsComments.list=[].concat(v(t.goodsComments.list),v(e)),s.data.count>t.goodsComments.list.length?(t.goodsComments.loadStatus="more",t.goodsComments.page++):t.goodsComments.loadStatus="noMore"}else t.$common.errorToShow(s.msg)})},goodsBrowsing:function(){var t={goods_id:this.goodsInfo.id};this.$api.addGoodsBrowsing(t,function(t){})},addToCart:function(){var t=this;if(this.buyNum>0){var s={product_id:this.product.id,nums:this.buyNum};this.$api.addCart(s,function(s){s.status?(t.toclose(),t.getCartNums(),t.$common.successToShow(s.msg)):t.$common.errorToShow(s.msg),t.submitStatus=!1})}else this.submitStatus=!1},buyNow:function(){var t=this;if(this.buyNum>0){var s={product_id:this.product.id,nums:this.buyNum,type:2};this.$api.addCart(s,function(s){if(s.status){t.toclose();var e=s.data;t.$common.navigateTo("/pages/goods/place-order/index?cart_ids="+JSON.stringify(e))}t.submitStatus=!1})}else this.submitStatus=!1},redirectCart:function(){t.switchTab({url:"/pages/cart/index/index"})},clickHandle:function(){this.submitStatus=!0,1===this.type?this.addToCart():this.buyNow()},trigger:function(s){this.content[s.index].active=!s.item.active,t.switchTab({url:s.item.url})},goShare:function(){this.$refs.share.show()},closeShare:function(){this.$refs.share.close()},clickImg:function(s){t.previewImage({urls:s.split()})},getMyShareCode:function(){var t=this,s=this.$db.get("userToken");s&&""!=s&&this.$api.shareCode({},function(s){s.status&&(t.myShareCode=s.data?s.data:"")})}},onShareAppMessage:function(){var t=this.myShareCode?this.myShareCode:"",s=this.$common.shareParameterDecode("type=2&id="+this.goodsInfo.id+"&invite="+t),e="/pages/share/jump?scene="+s;return{title:this.goodsInfo.name,imageUrl:this.goodsInfo.album[0],path:e}}};s.default=b}).call(this,e("543d")["default"])},"1a9d":function(t,s,e){},"726a":function(t,s,e){"use strict";e.r(s);var i=e("f47a"),o=e("b0d5");for(var a in o)"default"!==a&&function(t){e.d(s,t,function(){return o[t]})}(a);e("8166");var c=e("2877"),n=Object(c["a"])(o["default"],i["a"],i["b"],!1,null,null,null);s["default"]=n.exports},8166:function(t,s,e){"use strict";var i=e("1a9d"),o=e.n(i);o.a},b0d5:function(t,s,e){"use strict";e.r(s);var i=e("1732"),o=e.n(i);for(var a in i)"default"!==a&&function(t){e.d(s,t,function(){return i[t]})}(a);s["default"]=o.a},ecbd:function(t,s,e){"use strict";e("faac");var i=a(e("b0ce")),o=a(e("726a"));function a(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(o.default))},f47a:function(t,s,e){"use strict";var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("view",{staticClass:"content"},[e("view",{staticClass:"nav-back"},[e("view",{staticClass:"back-btn",attrs:{eventid:"4c7d3db2-0"},on:{click:function(s){t.backBtn()}}},[e("image",{staticClass:"icon",attrs:{src:"/static/image/back-black.png",mode:""}})])]),e("view",{staticClass:"content-top"},[e("view",{staticClass:"swiper"},[e("swiper",{staticClass:"swiper-c",attrs:{"indicator-dots":t.swiper.indicatorDots,autoplay:t.swiper.autoplay,interval:t.swiper.interval,duration:t.swiper.duration}},t._l(t.goodsInfo.album,function(s,i){return e("swiper-item",{key:i,staticClass:"have-none",attrs:{eventid:"4c7d3db2-1-"+i,mpcomid:"4c7d3db2-0-"+i},on:{click:function(e){t.clickImg(s)}}},[e("image",{attrs:{src:s,mode:"aspectFill"}})])}))],1),e("view",{staticClass:"cell-group"},[e("view",{staticClass:"cell-item goods-top"},[e("view",{staticClass:"cell-item-hd"},[e("view",{staticClass:"cell-hd-title goods-price red-price"},[t._v("￥"+t._s(t.product.price))]),parseFloat(t.product.mktprice)>0?e("view",{staticClass:"cell-hd-title goods-price cost-price"},[t._v("￥"+t._s(t.product.mktprice))]):t._e()]),e("view",{staticClass:"cell-item-ft"},[e("text",[t._v(t._s(t.goodsInfo.buy_count)+" 人已购买")])])]),e("view",{staticClass:"cell-item goods-details"},[e("view",{staticClass:"cell-item-hd"},[e("view",{staticClass:"cell-hd-title"},[e("view",{staticClass:"color-3 fsz28 cell-hd-title-view"},[t._v(t._s(t.product.name))]),t.goodsInfo.brief?e("text",{staticClass:"color-9 fsz24 "},[t._v(t._s(t.goodsInfo.brief))]):t._e()])]),e("view",{staticClass:"cell-item-ft"},[e("image",{staticClass:"cell-ft-next icon",attrs:{src:"/static/image/share.png",eventid:"4c7d3db2-2"},on:{click:function(s){t.goShare()}}})])]),t.promotion.length?e("view",{staticClass:"cell-item goods-title-item"},[t._m(0),e("view",{staticClass:"cell-item-bd"},[e("view",{staticClass:"romotion-tip"},t._l(t.promotion,function(s,i){return e("view",{key:i,staticClass:"romotion-tip-item",class:2!==s.type?"bg-gray":""},[t._v(t._s(s.name))])}))])]):t._e(),t.isSpes?e("view",{staticClass:"cell-item goods-title-item"},[t._m(1),e("view",{staticClass:"cell-item-bd",attrs:{eventid:"4c7d3db2-3"},on:{click:function(s){t.toshow()}}},[e("text",{staticClass:"cell-bd-text"},[t._v(t._s(t.product.spes_desc))])])]):t._e(),t._m(2)]),e("view",{staticClass:"goods-content"},[e("uni-segmented-control",{attrs:{current:t.current,values:t.items,"style-type":"text","active-color":"#333",eventid:"4c7d3db2-4",mpcomid:"4c7d3db2-1"},on:{clickItem:t.onClickItem}}),e("view",{staticClass:"goods-content-c"},[e("view",{directives:[{name:"show",rawName:"v-show",value:0===t.current,expression:"current === 0"}],staticClass:"goods-detail"},[t.goodsInfo.intro?e("jshopContent",{attrs:{content:t.goodsInfo.intro,mpcomid:"4c7d3db2-2"}}):t._e()],1),e("view",{directives:[{name:"show",rawName:"v-show",value:1===t.current,expression:"current === 1"}],staticClass:"goods-parameter"},[t.goodsParams.length?e("view",{staticClass:"cell-group"},t._l(t.goodsParams,function(s,i){return e("view",{key:i,staticClass:"cell-item"},[e("view",{staticClass:"cell-item-hd"},[e("view",{staticClass:"cell-hd-title"},[t._v(t._s(s.name))])]),e("view",{staticClass:"cell-item-bd"},[e("text",{staticClass:"cell-bd-text"},[t._v(t._s(s.value))])])])})):t._e()]),e("view",{directives:[{name:"show",rawName:"v-show",value:2===t.current,expression:"current === 2"}],staticClass:"goods-assess"},[t.goodsComments.list.length?e("view",[t._l(t.goodsComments.list,function(s,i){return e("view",{key:i,staticClass:"goods-assess-item"},[e("view",{staticClass:"cell-group"},[e("view",{staticClass:"cell-item goods-title-item"},[e("view",{staticClass:"cell-item-hd"},[e("image",{staticClass:"user-head-img",attrs:{src:s.user.avatar,mode:"aspectFill"}})]),e("view",{staticClass:"cell-item-bd"},[e("view",{staticClass:"cell-bd-view"},[e("text",{staticClass:"cell-bd-text"},[t._v(t._s(s.user.nickname&&""!=s.user.nickname?s.user.nickname:s.user.mobile))]),e("view",{staticClass:"cell-bd-text-right"},[e("uni-rate",{attrs:{size:"16",disabled:"true",value:s.score,mpcomid:"4c7d3db2-3-"+i}})],1)]),e("view",{staticClass:"cell-bd-view"},[e("text",{staticClass:"cell-bd-text color-9",staticStyle:{"margin-right":"16rpx"}},[t._v(t._s(s.ctime))]),e("text",{staticClass:"cell-bd-text color-9"},[t._v(t._s(s.addon))])])])])]),e("view",{staticClass:"gai-body"},[e("view",{staticClass:"gai-body-text"},[t._v(t._s(s.content))]),s.images_url.length?e("view",{staticClass:"gai-body-img"},t._l(s.images_url,function(s,o){return e("image",{key:o,attrs:{src:s,mode:"aspectFill",eventid:"4c7d3db2-5-"+i+"-"+o},on:{click:function(e){t.clickImg(s)}}})})):t._e(),s.seller_content?e("view",{staticClass:"seller-content"},[t._m(3,!0),t._v(t._s(s.seller_content))]):t._e()])])}),e("uni-load-more",{attrs:{status:t.goodsComments.loadStatus,mpcomid:"4c7d3db2-4"}})],2):e("view",{staticClass:"comment-none"},[e("image",{staticClass:"comment-none-img",attrs:{src:"/static/image/order.png",mode:""}})])])])],1)]),e("lvv-popup",{ref:"share",attrs:{position:"bottom",mpcomid:"4c7d3db2-6"}},[e("shareByWx",{attrs:{goodsId:t.goodsInfo.id,shareImg:t.goodsInfo.image_url,shareTitle:t.goodsInfo.name,shareContent:t.goodsInfo.brief,shareHref:t.shareHref,eventid:"4c7d3db2-6",mpcomid:"4c7d3db2-5"},on:{close:function(s){t.closeShare()}}})],1),e("lvv-popup",{ref:"lvvpopref",attrs:{position:"bottom",mpcomid:"4c7d3db2-9"}},[e("view",{staticStyle:{width:"100%","max-height":"804rpx",background:"#FFFFFF",position:"absolute",left:"0",bottom:"0"}},[e("view",{staticClass:"pop-c"},[e("view",{staticClass:"pop-t"},[e("view",{staticClass:"goods-img"},[e("image",{attrs:{src:t.product.image_path,mode:"aspectFill"}})]),e("view",{staticClass:"goods-information"},[e("view",{staticClass:"pop-goods-name"},[t._v(t._s(t.product.name))]),e("view",{staticClass:"pop-goods-price red-price"},[t._v("￥ "+t._s(t.product.price))])]),e("view",{staticClass:"close-btn",attrs:{eventid:"4c7d3db2-7"},on:{click:function(s){t.toclose()}}},[e("image",{attrs:{src:"/static/image/close.png"}})])]),e("scroll-view",{staticClass:"pop-m",staticStyle:{"max-height":"560rpx"},attrs:{"scroll-y":"true"}},[e("spec",{ref:"spec",attrs:{spesData:t.product.default_spes_desc,eventid:"4c7d3db2-8",mpcomid:"4c7d3db2-7"},on:{changeSpes:t.changeSpes}}),e("view",{staticClass:"goods-number"},[e("text",{staticClass:"pop-m-title"},[t._v("数量")]),e("view",{staticClass:"pop-m-bd-in"},[e("uni-number-box",{attrs:{min:t.minNums,max:t.product.stock,value:t.buyNum,eventid:"4c7d3db2-9",mpcomid:"4c7d3db2-8"},on:{change:t.bindChange}})],1)])],1),e("view",{staticClass:"pop-b"},[t.product.stock?e("button",{staticClass:"btn btn-square btn-b btn-all",attrs:{"hover-class":"btn-hover2",disabled:t.submitStatus,loading:t.submitStatus,eventid:"4c7d3db2-10"},on:{click:function(s){t.clickHandle()}}},[t._v("确定")]):e("button",{staticClass:"btn btn-square btn-g btn-all"},[t._v("已售罄")])],1)],1)])]),e("div",{ref:"qrCodeDiv",attrs:{id:"qrCode"}}),e("view",{staticClass:"goods-bottom"},[e("view",{staticClass:"goods-bottom-ic",attrs:{eventid:"4c7d3db2-11"},on:{click:t.collection}},[e("image",{staticClass:"icon",attrs:{src:t.isfav?t.favLogo[1]:t.favLogo[0],mode:""}}),t.isfav?t._e():e("view",[t._v("收藏")]),t.isfav?e("view",[t._v("已收藏")]):t._e()]),e("view",{staticClass:"goods-bottom-ic",attrs:{eventid:"4c7d3db2-12"},on:{click:t.redirectCart}},[t.cartNums?e("view",{staticClass:"badge color-f"},[t._v(t._s(t.cartNums))]):t._e(),e("image",{staticClass:"icon",attrs:{src:"/static/image/ic-me-car.png",mode:""}}),e("view",[t._v("购物车")])]),e("button",{staticClass:"btn btn-square btn-g",attrs:{"hover-class":"btn-hover2",eventid:"4c7d3db2-13"},on:{click:function(s){t.toshow(1)}}},[t._v("加入购物车")]),e("button",{staticClass:"btn btn-square btn-b",attrs:{"hover-class":"btn-hover2",eventid:"4c7d3db2-14"},on:{click:function(s){t.toshow(2)}}},[t._v("立即购买")])],1),e("uni-fab",{attrs:{pattern:t.pattern,content:t.content,horizontal:t.horizontal,vertical:t.vertical,direction:t.direction,eventid:"4c7d3db2-15",mpcomid:"4c7d3db2-10"},on:{trigger:t.trigger}})],1)},o=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("view",{staticClass:"cell-item-hd"},[e("view",{staticClass:"cell-hd-title"},[t._v("促销")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("view",{staticClass:"cell-item-hd"},[e("view",{staticClass:"cell-hd-title"},[t._v("规格")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("view",{staticClass:"cell-item goods-title-item"},[e("view",{staticClass:"cell-item-hd"},[e("view",{staticClass:"cell-hd-title"},[t._v("说明")])]),e("view",{staticClass:"cell-item-bd"},[e("view",{staticClass:"cell-bd-view"},[e("image",{staticClass:"goods-title-item-ic",attrs:{src:"/static/image/ic-dui.png",mode:""}}),e("text",{staticClass:"cell-bd-text"},[t._v("24小时内发货")])]),e("view",{staticClass:"cell-bd-view"},[e("image",{staticClass:"goods-title-item-ic",attrs:{src:"/static/image/ic-dui.png",mode:""}}),e("text",{staticClass:"cell-bd-text"},[t._v("7天拆封无条件退货")])])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("view",{staticClass:"seller-content-top"},[e("image",{staticClass:"seller-content-img",attrs:{src:"/static/image/seller-content.png"}}),t._v("掌柜回复")])}];e.d(s,"a",function(){return i}),e.d(s,"b",function(){return o})}},[["ecbd","common/runtime","common/vendor"]]]);