(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login/index"],{"659b":function(e,t,o){"use strict";o.r(t);var i=o("b918"),n=o.n(i);for(var s in i)"default"!==s&&function(e){o.d(t,e,function(){return i[e]})}(s);t["default"]=n.a},"6f9a":function(e,t,o){"use strict";o("faac");var i=s(o("b0ce")),n=s(o("f8bb"));function s(e){return e&&e.__esModule?e:{default:e}}Page((0,i.default)(n.default))},"7a7c":function(e,t,o){"use strict";var i=o("dd4c"),n=o.n(i);n.a},a7e2:function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("view",{staticClass:"content"},[o("view",{staticClass:"login-t"},[o("image",{staticClass:"login-logo",attrs:{src:e.logoImage,mode:"aspectFill"}})]),o("view",{staticClass:"login-m"},[o("view",{staticClass:"login-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.mobile,expression:"mobile"}],attrs:{type:"number",maxlength:e.maxMobile,placeholder:"请输入手机号码",focus:"","placeholder-class":"login-item-i-p",eventid:"5d486e11-0"},domProps:{value:e.mobile},on:{input:function(t){t.target.composing||(e.mobile=t.target.value)}}})]),o("view",{staticClass:"login-item flc"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],staticClass:"login-item-input",attrs:{"placeholder-class":"login-item-i-p",type:"text",placeholder:"请输入验证码",eventid:"5d486e11-1"},domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}}),e.verification?o("view",{class:e.sendCodeBtn,attrs:{eventid:"5d486e11-2"},on:{click:e.sendCode}},[e._v("发送验证码")]):e._e(),e.verification?e._e():o("view",{staticClass:"btn btn-g"},[e._v(e._s(e.timer)+" 秒后重新获取")])])]),o("view",{staticClass:"login-b"},[o("button",{class:e.regButtonClass,attrs:{"hover-class":"btn-hover",eventid:"5d486e11-3"},on:{click:function(t){e.showTopTips()}}},[e._v("登录")])],1)])},n=[];o.d(t,"a",function(){return i}),o.d(t,"b",function(){return n})},b918:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o("1fc7"),n={mixins:[i.goBack,i.jumpBackPage],data:function(){return{maxMobile:11,mobile:"",code:"",user_wx_id:"",verification:!0,timer:60,btnb:"btn btn-square btn-c btn-all",type:"",isWeixinBrowser:this.$common.isWeiXinBrowser()}},onLoad:function(t){t.user_wx_id&&(this.user_wx_id=t.user_wx_id,e.setNavigationBarTitle({title:"绑定手机号"}))},computed:{rightMobile:function(){var e={};return this.mobile?/^1[3456789]{1}\d{9}$/gi.test(this.mobile)?e.status=!0:(e.status=!1,e.msg="手机号格式不正确"):(e.status=!1,e.msg="请输入手机号"),e},sendCodeBtn:function(){var e="btn btn-g";return this.mobile.length===this.maxMobile&&this.rightMobile.status?e+" btn-b":e},regButtonClass:function(){return this.mobile&&this.mobile.length===this.maxMobile&&this.code?this.btnb+" btn-b":this.btnb},logoImage:function(){var e=this.$store.state.config.shop_logo;return void 0==e&&(e="/static/img/default.jpg"),e}},onShow:function(){var t=this,o=t.$db.get("userToken");if(o)return e.switchTab({url:"/pages/member/index/index"}),!0;t.timer=parseInt(t.$db.get("timer")),null!=t.timer&&t.timer>0&&(t.countDown(),t.verification=!1)},methods:{sendCode:function(){var e=this;this.rightMobile.status?(this.$common.loadToShow("发送中..."),setTimeout(function(){e.$common.loadToHide(),e.$api.sms({telephone:e.mobile},function(t){t.isSucess?(console.log(t),e.timer=60,e.verification=!1,e.code=t.data,e.$common.successToShow(t.msg),e.countDown()):e.$common.errorToShow(t.msg)})},1e3)):this.$common.errorToShow(this.rightMobile.msg)},toReg:function(){this.$common.navigateTo("/pages/login/register/index")},countDown:function(){var t=this,o=setInterval(function(){t.timer--,e.setStorage({key:"timer",data:t.timer,success:function(){}}),t.timer<=0&&(t.verification=!0,clearInterval(o))},1e3)},login:function(){var e=this,t=this;if(t.rightMobile.status)if(t.code){var o={telephone:t.mobile,smsCode:t.code},i=t.$db.get("invitecode");i&&(o.invitecode=i),t.$api.smsLogin(o,function(o){o.isSucess?(e.$db.set("userToken",o.data.token),t.redirectHandler()):t.$common.errorToShow(o.msg)})}else t.$common.errorToShow("请输入短信验证码!");else t.$common.errorToShow(t.rightMobile.msg)},redirectHandler:function(){var e=this;this.$common.successToShow("登录成功!",function(){e.$db.set("timer",0),e.$db.del("invitecode"),e.handleBack()})},toLogin:function(){e.navigateTo({url:"../../login/login/index"})},showTopTips:function(){var t=this;if(""==t.mobile)return t.$common.errorToShow("请输入手机号码"),!1;if(""==this.code)return t.$common.errorToShow("请输入验证码"),!1;if(0==t.user_wx_id)return t.$common.errorToShow("登录失败，请稍后再试",function(){e.navigateBack({delta:1})}),!1;var o=2,i={mobile:t.mobile,code:t.code,platform:o,user_wx_id:t.user_wx_id},n=t.$db.get("invitecode");n&&(i.invitecode=n),t.$api.smsLogin(i,function(e){e.status?(t.$db.set("userToken",e.data),t.redirectHandler()):t.$common.errorToShow(e.msg)})},toBind:function(){var e=this;if(""==this.mobile)return this.$common.errorToShow("请输入手机号码"),!1;if(""==this.code)return this.$common.errorToShow("请输入验证码"),!1;var t={mobile:this.mobile,code:this.code,user_wx_id:this.user_wx_id},o=this.$db.get("invitecode");o&&(t.invitecode=o),this.$api.smsLogin(t,function(t){t.status?(e.$db.set("userToken",t.data),e.redirectHandler()):e.$common.errorToShow(t.msg)})},selectLoginType:function(){this.$common.redirectTo("./index1")}}};t.default=n}).call(this,o("543d")["default"])},dd4c:function(e,t,o){},f8bb:function(e,t,o){"use strict";o.r(t);var i=o("a7e2"),n=o("659b");for(var s in n)"default"!==s&&function(e){o.d(t,e,function(){return n[e]})}(s);o("7a7c");var r=o("2877"),a=Object(r["a"])(n["default"],i["a"],i["b"],!1,null,null,null);t["default"]=a.exports}},[["6f9a","common/runtime","common/vendor"]]]);